'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _axisUtils = require('../utils/axis-utils');

var _scalesUtils = require('../utils/scales-utils');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Copyright (c) 2016 Uber Technologies, Inc.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

var LEFT = _axisUtils.ORIENTATION.LEFT;
var RIGHT = _axisUtils.ORIENTATION.RIGHT;
var TOP = _axisUtils.ORIENTATION.TOP;
var BOTTOM = _axisUtils.ORIENTATION.BOTTOM;


var propTypes = {
  width: _react2.default.PropTypes.number.isRequired,
  height: _react2.default.PropTypes.number.isRequired,
  orientation: _react2.default.PropTypes.oneOf([LEFT, RIGHT, TOP, BOTTOM]).isRequired
};

function _getTickTextAttributes(orientation) {
  var textAnchor = orientation === LEFT ? 'end' : orientation === RIGHT ? 'start' : 'middle';
  var dy = orientation === TOP ? '0' : orientation === BOTTOM ? '0.72em' : '0.32em';
  return {
    textAnchor: textAnchor,
    dy: dy
  };
}

var AxisTicks = function (_React$Component) {
  _inherits(AxisTicks, _React$Component);

  function AxisTicks(props) {
    _classCallCheck(this, AxisTicks);

    return _possibleConstructorReturn(this, Object.getPrototypeOf(AxisTicks).call(this, props));
  }

  _createClass(AxisTicks, [{
    key: '_getTickFormatFn',
    value: function _getTickFormatFn(scale) {
      var tickFormat = this.props.tickFormat;

      return !tickFormat ? scale.tickFormat ? scale.tickFormat() : function (v) {
        return v;
      } : tickFormat;
    }
  }, {
    key: '_getTickValues',
    value: function _getTickValues(scale) {
      var _props = this.props;
      var tickTotal = _props.tickTotal;
      var tickValues = _props.tickValues;

      return !tickValues ? scale.ticks ? scale.ticks(tickTotal) : scale.domain() : tickValues;
    }
  }, {
    key: 'render',
    value: function render() {
      var _props2 = this.props;
      var orientation = _props2.orientation;
      var width = _props2.width;
      var height = _props2.height;

      var x = orientation === LEFT ? width : 0;
      var y = orientation === TOP ? height : 0;

      var _props3 = this.props;
      var attr = _props3.attr;
      var tickSize = _props3.tickSize;
      var tickPadding = _props3.tickPadding;

      var isVertical = orientation === LEFT || orientation === RIGHT;
      var _props4 = this.props;
      var _props4$tickSizeInner = _props4.tickSizeInner;
      var tickSizeInner = _props4$tickSizeInner === undefined ? tickSize : _props4$tickSizeInner;
      var _props4$tickSizeOuter = _props4.tickSizeOuter;
      var tickSizeOuter = _props4$tickSizeOuter === undefined ? tickSize : _props4$tickSizeOuter;

      var scale = (0, _scalesUtils.getAttributeScale)(this.props, attr);

      var wrap = orientation === LEFT || orientation === TOP ? -1 : 1;

      var values = this._getTickValues(scale);
      var tickFormatFn = this._getTickFormatFn(scale);

      var tickXAttr = isVertical ? 'y' : 'x';
      var tickYAttr = isVertical ? 'x' : 'y';

      var ticks = values.map(function (v, i) {
        var _pathProps, _extends2;

        var pos = scale(v);
        var text = tickFormatFn(v);
        var pathProps = (_pathProps = {}, _defineProperty(_pathProps, tickXAttr + '1', pos), _defineProperty(_pathProps, tickXAttr + '2', pos), _defineProperty(_pathProps, tickYAttr + '1', -wrap * tickSizeOuter), _defineProperty(_pathProps, tickYAttr + '2', wrap * tickSizeInner), _pathProps);
        var textProps = _extends((_extends2 = {}, _defineProperty(_extends2, tickXAttr, pos), _defineProperty(_extends2, tickYAttr, wrap * (tickSizeOuter + tickPadding)), _extends2), _getTickTextAttributes(orientation));
        return _react2.default.createElement(
          'g',
          { key: i, className: 'rv-xy-plot__axis__tick' },
          _react2.default.createElement('line', _extends({}, pathProps, { className: 'rv-xy-plot__axis__tick__line' })),
          _react2.default.createElement(
            'text',
            _extends({}, textProps, { className: 'rv-xy-plot__axis__tick__text' }),
            text
          )
        );
      });

      return _react2.default.createElement(
        'g',
        {
          transform: 'translate(' + x + ', ' + y + ')',
          className: 'rv-xy-plot__axis__ticks' },
        ticks
      );
    }
  }]);

  return AxisTicks;
}(_react2.default.Component);

AxisTicks.displayName = 'AxisTicks';
AxisTicks.propTypes = propTypes;

exports.default = AxisTicks;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvcGxvdC9heGlzLXRpY2tzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFvQkE7Ozs7QUFDQTs7QUFDQTs7Ozs7Ozs7OzsrZUF0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0lBTU8sSSwwQkFBQSxJO0lBQU0sSywwQkFBQSxLO0lBQU8sRywwQkFBQSxHO0lBQUssTSwwQkFBQSxNOzs7QUFFekIsSUFBTSxZQUFZO0FBQ2hCLFNBQU8sZ0JBQU0sU0FBTixDQUFnQixNQUFoQixDQUF1QixVQURkO0FBRWhCLFVBQVEsZ0JBQU0sU0FBTixDQUFnQixNQUFoQixDQUF1QixVQUZmO0FBR2hCLGVBQWEsZ0JBQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixDQUNqQyxJQURpQyxFQUMzQixLQUQyQixFQUNwQixHQURvQixFQUNmLE1BRGUsQ0FBdEIsRUFFVjtBQUxhLENBQWxCOztBQVFBLFNBQVMsc0JBQVQsQ0FBZ0MsV0FBaEMsRUFBNkM7QUFDM0MsTUFBTSxhQUFhLGdCQUFnQixJQUFoQixHQUNqQixLQURpQixHQUVoQixnQkFBZ0IsS0FBaEIsR0FBd0IsT0FBeEIsR0FBa0MsUUFGckM7QUFHQSxNQUFNLEtBQUssZ0JBQWdCLEdBQWhCLEdBQ1QsR0FEUyxHQUVSLGdCQUFnQixNQUFoQixHQUF5QixRQUF6QixHQUFtQyxRQUZ0QztBQUdBLFNBQU87QUFDTCwwQkFESztBQUVMO0FBRkssR0FBUDtBQUlEOztJQUVLLFM7OztBQUVKLHFCQUFZLEtBQVosRUFBbUI7QUFBQTs7QUFBQSx3RkFDWCxLQURXO0FBRWxCOzs7O3FDQUVnQixLLEVBQU87QUFBQSxVQUNmLFVBRGUsR0FDRCxLQUFLLEtBREosQ0FDZixVQURlOztBQUV0QixhQUFPLENBQUMsVUFBRCxHQUNKLE1BQU0sVUFBTixHQUFtQixNQUFNLFVBQU4sRUFBbkIsR0FBd0M7QUFBQSxlQUFLLENBQUw7QUFBQSxPQURwQyxHQUVMLFVBRkY7QUFHRDs7O21DQUVjLEssRUFBTztBQUFBLG1CQUNZLEtBQUssS0FEakI7QUFBQSxVQUNiLFNBRGEsVUFDYixTQURhO0FBQUEsVUFDRixVQURFLFVBQ0YsVUFERTs7QUFFcEIsYUFBTyxDQUFDLFVBQUQsR0FDSixNQUFNLEtBQU4sR0FBYyxNQUFNLEtBQU4sQ0FBWSxTQUFaLENBQWQsR0FBdUMsTUFBTSxNQUFOLEVBRG5DLEdBRUwsVUFGRjtBQUdEOzs7NkJBRVE7QUFBQSxvQkFDOEIsS0FBSyxLQURuQztBQUFBLFVBQ0EsV0FEQSxXQUNBLFdBREE7QUFBQSxVQUNhLEtBRGIsV0FDYSxLQURiO0FBQUEsVUFDb0IsTUFEcEIsV0FDb0IsTUFEcEI7O0FBRVAsVUFBTSxJQUFJLGdCQUFnQixJQUFoQixHQUF1QixLQUF2QixHQUErQixDQUF6QztBQUNBLFVBQU0sSUFBSSxnQkFBZ0IsR0FBaEIsR0FBc0IsTUFBdEIsR0FBK0IsQ0FBekM7O0FBSE8sb0JBU0gsS0FBSyxLQVRGO0FBQUEsVUFNTCxJQU5LLFdBTUwsSUFOSztBQUFBLFVBT0wsUUFQSyxXQU9MLFFBUEs7QUFBQSxVQVFMLFdBUkssV0FRTCxXQVJLOztBQVVQLFVBQU0sYUFBYSxnQkFBZ0IsSUFBaEIsSUFBd0IsZ0JBQWdCLEtBQTNEO0FBVk8sb0JBY0gsS0FBSyxLQWRGO0FBQUEsMENBWUwsYUFaSztBQUFBLFVBWUwsYUFaSyx5Q0FZVyxRQVpYO0FBQUEsMENBYUwsYUFiSztBQUFBLFVBYUwsYUFiSyx5Q0FhVyxRQWJYOztBQWVQLFVBQU0sUUFBUSxvQ0FBa0IsS0FBSyxLQUF2QixFQUE4QixJQUE5QixDQUFkOztBQUVBLFVBQU0sT0FBUSxnQkFBZ0IsSUFBaEIsSUFBd0IsZ0JBQWdCLEdBQXpDLEdBQWdELENBQUMsQ0FBakQsR0FBcUQsQ0FBbEU7O0FBRUEsVUFBTSxTQUFTLEtBQUssY0FBTCxDQUFvQixLQUFwQixDQUFmO0FBQ0EsVUFBTSxlQUFlLEtBQUssZ0JBQUwsQ0FBc0IsS0FBdEIsQ0FBckI7O0FBRUEsVUFBTSxZQUFZLGFBQWEsR0FBYixHQUFtQixHQUFyQztBQUNBLFVBQU0sWUFBWSxhQUFhLEdBQWIsR0FBbUIsR0FBckM7O0FBRUEsVUFBTSxRQUFRLE9BQU8sR0FBUCxDQUFXLFVBQUMsQ0FBRCxFQUFJLENBQUosRUFBVTtBQUFBOztBQUNqQyxZQUFNLE1BQU0sTUFBTSxDQUFOLENBQVo7QUFDQSxZQUFNLE9BQU8sYUFBYSxDQUFiLENBQWI7QUFDQSxZQUFNLDBEQUNBLFNBREEsUUFDZSxHQURmLCtCQUVBLFNBRkEsUUFFZSxHQUZmLCtCQUdBLFNBSEEsUUFHZSxDQUFDLElBQUQsR0FBUSxhQUh2QiwrQkFJQSxTQUpBLFFBSWUsT0FBTyxhQUp0QixjQUFOO0FBTUEsWUFBTSxpRUFDSCxTQURHLEVBQ1MsR0FEVCw4QkFFSCxTQUZHLEVBRVMsUUFBUSxnQkFBZ0IsV0FBeEIsQ0FGVCxlQUdELHVCQUF1QixXQUF2QixDQUhDLENBQU47QUFLQSxlQUNFO0FBQUE7QUFBQSxZQUFHLEtBQUssQ0FBUixFQUFXLFdBQVUsd0JBQXJCO0FBQ0UsNkRBQVUsU0FBVixJQUFxQixXQUFVLDhCQUEvQixJQURGO0FBRUU7QUFBQTtBQUFBLHlCQUFVLFNBQVYsSUFBcUIsV0FBVSw4QkFBL0I7QUFDRztBQURIO0FBRkYsU0FERjtBQVFELE9BdEJhLENBQWQ7O0FBd0JBLGFBQ0U7QUFBQTtBQUFBO0FBQ0Usb0NBQXdCLENBQXhCLFVBQThCLENBQTlCLE1BREY7QUFFRSxxQkFBVSx5QkFGWjtBQUdHO0FBSEgsT0FERjtBQU9EOzs7O0VBNUVxQixnQkFBTSxTOztBQStFOUIsVUFBVSxXQUFWLEdBQXdCLFdBQXhCO0FBQ0EsVUFBVSxTQUFWLEdBQXNCLFNBQXRCOztrQkFFZSxTIiwiZmlsZSI6ImF4aXMtdGlja3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMTYgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1Jcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuLy8gVEhFIFNPRlRXQVJFLlxuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtPUklFTlRBVElPTn0gZnJvbSAnLi4vdXRpbHMvYXhpcy11dGlscyc7XG5pbXBvcnQge2dldEF0dHJpYnV0ZVNjYWxlfSBmcm9tICcuLi91dGlscy9zY2FsZXMtdXRpbHMnO1xuXG5jb25zdCB7TEVGVCwgUklHSFQsIFRPUCwgQk9UVE9NfSA9IE9SSUVOVEFUSU9OO1xuXG5jb25zdCBwcm9wVHlwZXMgPSB7XG4gIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICBvcmllbnRhdGlvbjogUmVhY3QuUHJvcFR5cGVzLm9uZU9mKFtcbiAgICBMRUZULCBSSUdIVCwgVE9QLCBCT1RUT01cbiAgXSkuaXNSZXF1aXJlZFxufTtcblxuZnVuY3Rpb24gX2dldFRpY2tUZXh0QXR0cmlidXRlcyhvcmllbnRhdGlvbikge1xuICBjb25zdCB0ZXh0QW5jaG9yID0gb3JpZW50YXRpb24gPT09IExFRlQgP1xuICAgICdlbmQnIDpcbiAgICAob3JpZW50YXRpb24gPT09IFJJR0hUID8gJ3N0YXJ0JyA6ICdtaWRkbGUnKTtcbiAgY29uc3QgZHkgPSBvcmllbnRhdGlvbiA9PT0gVE9QID9cbiAgICAnMCcgOlxuICAgIChvcmllbnRhdGlvbiA9PT0gQk9UVE9NID8gJzAuNzJlbSc6ICcwLjMyZW0nKTtcbiAgcmV0dXJuIHtcbiAgICB0ZXh0QW5jaG9yLFxuICAgIGR5XG4gIH07XG59XG5cbmNsYXNzIEF4aXNUaWNrcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICBfZ2V0VGlja0Zvcm1hdEZuKHNjYWxlKSB7XG4gICAgY29uc3Qge3RpY2tGb3JtYXR9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gIXRpY2tGb3JtYXQgP1xuICAgICAgKHNjYWxlLnRpY2tGb3JtYXQgPyBzY2FsZS50aWNrRm9ybWF0KCkgOiB2ID0+IHYpIDpcbiAgICAgIHRpY2tGb3JtYXQ7XG4gIH1cblxuICBfZ2V0VGlja1ZhbHVlcyhzY2FsZSkge1xuICAgIGNvbnN0IHt0aWNrVG90YWwsIHRpY2tWYWx1ZXN9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gIXRpY2tWYWx1ZXMgP1xuICAgICAgKHNjYWxlLnRpY2tzID8gc2NhbGUudGlja3ModGlja1RvdGFsKSA6IHNjYWxlLmRvbWFpbigpKSA6XG4gICAgICB0aWNrVmFsdWVzO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtvcmllbnRhdGlvbiwgd2lkdGgsIGhlaWdodH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHggPSBvcmllbnRhdGlvbiA9PT0gTEVGVCA/IHdpZHRoIDogMDtcbiAgICBjb25zdCB5ID0gb3JpZW50YXRpb24gPT09IFRPUCA/IGhlaWdodCA6IDA7XG5cbiAgICBjb25zdCB7XG4gICAgICBhdHRyLFxuICAgICAgdGlja1NpemUsXG4gICAgICB0aWNrUGFkZGluZ1xuICAgIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGlzVmVydGljYWwgPSBvcmllbnRhdGlvbiA9PT0gTEVGVCB8fCBvcmllbnRhdGlvbiA9PT0gUklHSFQ7XG4gICAgY29uc3Qge1xuICAgICAgdGlja1NpemVJbm5lciA9IHRpY2tTaXplLFxuICAgICAgdGlja1NpemVPdXRlciA9IHRpY2tTaXplXG4gICAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qgc2NhbGUgPSBnZXRBdHRyaWJ1dGVTY2FsZSh0aGlzLnByb3BzLCBhdHRyKTtcblxuICAgIGNvbnN0IHdyYXAgPSAob3JpZW50YXRpb24gPT09IExFRlQgfHwgb3JpZW50YXRpb24gPT09IFRPUCkgPyAtMSA6IDE7XG5cbiAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLl9nZXRUaWNrVmFsdWVzKHNjYWxlKTtcbiAgICBjb25zdCB0aWNrRm9ybWF0Rm4gPSB0aGlzLl9nZXRUaWNrRm9ybWF0Rm4oc2NhbGUpO1xuXG4gICAgY29uc3QgdGlja1hBdHRyID0gaXNWZXJ0aWNhbCA/ICd5JyA6ICd4JztcbiAgICBjb25zdCB0aWNrWUF0dHIgPSBpc1ZlcnRpY2FsID8gJ3gnIDogJ3knO1xuXG4gICAgY29uc3QgdGlja3MgPSB2YWx1ZXMubWFwKCh2LCBpKSA9PiB7XG4gICAgICBjb25zdCBwb3MgPSBzY2FsZSh2KTtcbiAgICAgIGNvbnN0IHRleHQgPSB0aWNrRm9ybWF0Rm4odik7XG4gICAgICBjb25zdCBwYXRoUHJvcHMgPSB7XG4gICAgICAgIFtgJHt0aWNrWEF0dHJ9MWBdOiBwb3MsXG4gICAgICAgIFtgJHt0aWNrWEF0dHJ9MmBdOiBwb3MsXG4gICAgICAgIFtgJHt0aWNrWUF0dHJ9MWBdOiAtd3JhcCAqIHRpY2tTaXplT3V0ZXIsXG4gICAgICAgIFtgJHt0aWNrWUF0dHJ9MmBdOiB3cmFwICogdGlja1NpemVJbm5lclxuICAgICAgfTtcbiAgICAgIGNvbnN0IHRleHRQcm9wcyA9IHtcbiAgICAgICAgW3RpY2tYQXR0cl06IHBvcyxcbiAgICAgICAgW3RpY2tZQXR0cl06IHdyYXAgKiAodGlja1NpemVPdXRlciArIHRpY2tQYWRkaW5nKSxcbiAgICAgICAgLi4uX2dldFRpY2tUZXh0QXR0cmlidXRlcyhvcmllbnRhdGlvbilcbiAgICAgIH07XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8ZyBrZXk9e2l9IGNsYXNzTmFtZT1cInJ2LXh5LXBsb3RfX2F4aXNfX3RpY2tcIj5cbiAgICAgICAgICA8bGluZSB7Li4ucGF0aFByb3BzfSBjbGFzc05hbWU9XCJydi14eS1wbG90X19heGlzX190aWNrX19saW5lXCIvPlxuICAgICAgICAgIDx0ZXh0IHsuLi50ZXh0UHJvcHN9IGNsYXNzTmFtZT1cInJ2LXh5LXBsb3RfX2F4aXNfX3RpY2tfX3RleHRcIj5cbiAgICAgICAgICAgIHt0ZXh0fVxuICAgICAgICAgIDwvdGV4dD5cbiAgICAgICAgPC9nPlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIHJldHVybiAoXG4gICAgICA8Z1xuICAgICAgICB0cmFuc2Zvcm09e2B0cmFuc2xhdGUoJHt4fSwgJHt5fSlgfVxuICAgICAgICBjbGFzc05hbWU9XCJydi14eS1wbG90X19heGlzX190aWNrc1wiPlxuICAgICAgICB7dGlja3N9XG4gICAgICA8L2c+XG4gICAgKTtcbiAgfVxufVxuXG5BeGlzVGlja3MuZGlzcGxheU5hbWUgPSAnQXhpc1RpY2tzJztcbkF4aXNUaWNrcy5wcm9wVHlwZXMgPSBwcm9wVHlwZXM7XG5cbmV4cG9ydCBkZWZhdWx0IEF4aXNUaWNrcztcblxuIl19